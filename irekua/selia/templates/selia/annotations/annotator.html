{% extends 'selia/base_with_toolbar.html' %}

{% load i18n %}
{% load selia_components %}
{% load selia_buttons %}
{% load static %}

{% block secondary-navbar %}
  {% include 'selia/navbars/item.html' %}
{% endblock secondary-navbar %}

{% block stylesheet-extra %}
<link rel="stylesheet" type="text/css" href="{% static 'selia/css/image_annotator.css'%}">
{% endblock stylesheet-extra %}

{% block toolbar-title %}{{ item.collection }}{% trans ': Item ' %}{{ item.pk }}{% trans ': Annotations: Add' %}{% endblock %}

{% block toolbar-items %}
	<li class="nav-item">
		<a class="nav-link" href="{{ back }}">{% trans 'Back' %} <i class="fas fa-backspace"></i></a>
	</li>
  <li class="nav-item">
    {% help_button %}
  </li>
  {% if prev_object %}
    <li class="nav-item">
      <a class="nav-link" href="{% url 'selia:item_annotation_create' prev_object.pk %}?"><i class="fas fa-chevron-left"></i>{% trans 'Item ' %}{{ prev_object.pk }}</a>
    </li>
  {% endif %}
  {% if next_object %}
    <li class="nav-item">
      <a class="nav-link" href="{% url 'selia:item_annotation_create' next_object.pk %}?">{% trans 'Item ' %}{{ next_object.pk }}<i class="fas fa-chevron-right"></i></a>
    </li>
  {% endif %}
{% endblock toolbar-items %}

{% block main-content %}
	<div id="annotator">
  </div>
{% endblock main-content %}

{% block scripts-extra %}
{{ block.super }}
<script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>

<script type="text/javascript" src="{% static 'selia/js/annotator/annotator.js' %}"></script>
<script type="text/javascript">
  let Annotator = annotator.default;

  let urls = {
    item_type: "{% url 'rest-api:itemtype-detail' item.item_type.pk %}",
    item: "{% url 'rest-api:item-detail' item.pk %}",
  };

  let info = {
    item: "{{ item.pk }}",
    item_type: "{{ item.item_type.pk }}",
  }

  ReactDOM.render(
    React.createElement(Annotator, {urls: urls, info: info}, null),
    document.getElementById('annotator'));
</script>
{% endblock scripts-extra %}
